<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>åœ°çƒä»ªæµ‹è¯•</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      background: #1a1a2e;
      font-family: system-ui, -apple-system, sans-serif;
    }
    
    h1 {
      color: white;
      text-align: center;
    }
    
    #globe-container {
      width: 100%;
      height: 600px;
      margin: 2rem auto;
      max-width: 1200px;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
      background: linear-gradient(to bottom, #000428, #004e92);
    }
    
    #loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 1.2rem;
    }
  </style>
</head>
<body>
  <h1>ğŸŒ äº¤äº’å¼åœ°çƒä»ªæµ‹è¯•</h1>
  <div id="globe-container" style="position: relative;">
    <div id="loading">æ­£åœ¨åŠ è½½åœ°çƒä»ª...</div>
  </div>

  <script type="module">
    // ç›´æ¥ä½¿ç”¨ CDN
    import Globe from 'https://cdn.skypack.dev/globe.gl';

    // è¶³è¿¹æ•°æ®
    const footprints = [
      { lat: 39.9042, lng: 116.4074, name: 'åŒ—äº¬', year: 2024, color: '#ff6b6b', size: 0.5 },
      { lat: 31.2304, lng: 121.4737, name: 'ä¸Šæµ·', year: 2024, color: '#4ecdc4', size: 0.5 },
      { lat: 22.3193, lng: 114.1694, name: 'é¦™æ¸¯', year: 2023, color: '#45b7d1', size: 0.5 },
      { lat: 35.6762, lng: 139.6503, name: 'ä¸œäº¬', year: 2023, color: '#96ceb4', size: 0.5 },
      { lat: 37.5665, lng: 126.9780, name: 'é¦–å°”', year: 2022, color: '#ffeaa7', size: 0.5 },
      { lat: 1.3521, lng: 103.8198, name: 'æ–°åŠ å¡', year: 2022, color: '#dfe6e9', size: 0.5 },
    ];

    // è¿æ¥çº¿æ•°æ®
    const arcs = [
      { startLat: 39.9042, startLng: 116.4074, endLat: 31.2304, endLng: 121.4737 },
      { startLat: 31.2304, startLng: 121.4737, endLat: 22.3193, endLng: 114.1694 },
      { startLat: 22.3193, startLng: 114.1694, endLat: 35.6762, endLng: 139.6503 },
    ];

    try {
      const container = document.getElementById('globe-container');
      const loading = document.getElementById('loading');
      
      console.log('å¼€å§‹åˆå§‹åŒ–åœ°çƒä»ª...');
      
      const globe = Globe()(container)
        .globeImageUrl('https://unpkg.com/three-globe/example/img/earth-blue-marble.jpg')
        .bumpImageUrl('https://unpkg.com/three-globe/example/img/earth-topology.png')
        .backgroundImageUrl('https://unpkg.com/three-globe/example/img/night-sky.png')
        
        // æ·»åŠ è¶³è¿¹ç‚¹
        .pointsData(footprints)
        .pointAltitude('size')
        .pointColor('color')
        .pointRadius(0.5)
        .pointLabel((d) => `
          <div style="
            background: rgba(0, 0, 0, 0.8);
            padding: 8px 12px;
            border-radius: 6px;
            color: white;
          ">
            <strong>${d.name}</strong><br/>
            <span style="opacity: 0.8;">${d.year}</span>
          </div>
        `)
        
        // æ·»åŠ è¿æ¥çº¿
        .arcsData(arcs)
        .arcColor(() => 'rgba(255, 255, 255, 0.5)')
        .arcDashLength(0.4)
        .arcDashGap(0.2)
        .arcDashAnimateTime(2000)
        .arcStroke(0.5)
        
        // æ·»åŠ å…‰æ™•æ•ˆæœ
        .atmosphereColor('lightskyblue')
        .atmosphereAltitude(0.15)
        
        // æ§åˆ¶è®¾ç½®
        .enablePointerInteraction(true);

      // è‡ªåŠ¨æ—‹è½¬
      globe.controls().autoRotate = true;
      globe.controls().autoRotateSpeed = 0.5;
      globe.controls().enableZoom = true;

      // è®¾ç½®åˆå§‹è§†è§’
      globe.pointOfView({ lat: 35, lng: 105, altitude: 2 }, 1000);

      // å“åº”å¼å¤„ç†
      const handleResize = () => {
        globe.width(container.offsetWidth);
        globe.height(container.offsetHeight);
      };
      
      window.addEventListener('resize', handleResize);
      setTimeout(handleResize, 100);

      // æ·»åŠ ç‚¹å‡»äº¤äº’
      globe.onPointClick((point) => {
        globe.pointOfView({
          lat: point.lat,
          lng: point.lng,
          altitude: 1.5
        }, 1000);
      });

      // ç§»é™¤åŠ è½½æç¤º
      setTimeout(() => {
        if (loading) loading.style.display = 'none';
      }, 2000);

      console.log('åœ°çƒä»ªåˆå§‹åŒ–æˆåŠŸï¼');
    } catch (error) {
      console.error('åœ°çƒä»ªåŠ è½½å¤±è´¥:', error);
      document.getElementById('globe-container').innerHTML = `
        <div style="
          display: flex;
          align-items: center;
          justify-content: center;
          height: 100%;
          color: white;
          text-align: center;
          padding: 2rem;
        ">
          <div>
            <p style="font-size: 1.5rem; margin-bottom: 1rem;">ğŸ˜…</p>
            <p style="font-size: 1.2rem; margin-bottom: 0.5rem;">åœ°çƒä»ªåŠ è½½å¤±è´¥</p>
            <p style="opacity: 0.7;">é”™è¯¯: ${error.message}</p>
            <p style="opacity: 0.7; margin-top: 1rem;">è¯·æ£€æŸ¥æ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯</p>
          </div>
        </div>
      `;
    }
  </script>
</body>
</html>
